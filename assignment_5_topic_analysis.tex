% Options for packages loaded elsewhere
\PassOptionsToPackage{unicode}{hyperref}
\PassOptionsToPackage{hyphens}{url}
%
\documentclass[
]{article}
\usepackage{amsmath,amssymb}
\usepackage{lmodern}
\usepackage{iftex}
\ifPDFTeX
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
  \usepackage{textcomp} % provide euro and other symbols
\else % if luatex or xetex
  \usepackage{unicode-math}
  \defaultfontfeatures{Scale=MatchLowercase}
  \defaultfontfeatures[\rmfamily]{Ligatures=TeX,Scale=1}
\fi
% Use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
\IfFileExists{microtype.sty}{% use microtype if available
  \usepackage[]{microtype}
  \UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\makeatletter
\@ifundefined{KOMAClassName}{% if non-KOMA class
  \IfFileExists{parskip.sty}{%
    \usepackage{parskip}
  }{% else
    \setlength{\parindent}{0pt}
    \setlength{\parskip}{6pt plus 2pt minus 1pt}}
}{% if KOMA class
  \KOMAoptions{parskip=half}}
\makeatother
\usepackage{xcolor}
\IfFileExists{xurl.sty}{\usepackage{xurl}}{} % add URL line breaks if available
\IfFileExists{bookmark.sty}{\usepackage{bookmark}}{\usepackage{hyperref}}
\hypersetup{
  pdftitle={Topic 6: Topic Analysis},
  pdfauthor={Felicia Cruz, Mia Forsline, Cullen Molitor, Marie Rivers},
  hidelinks,
  pdfcreator={LaTeX via pandoc}}
\urlstyle{same} % disable monospaced font for URLs
\usepackage[margin=1in]{geometry}
\usepackage{color}
\usepackage{fancyvrb}
\newcommand{\VerbBar}{|}
\newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
% Add ',fontsize=\small' for more characters per line
\usepackage{framed}
\definecolor{shadecolor}{RGB}{248,248,248}
\newenvironment{Shaded}{\begin{snugshade}}{\end{snugshade}}
\newcommand{\AlertTok}[1]{\textcolor[rgb]{0.94,0.16,0.16}{#1}}
\newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.77,0.63,0.00}{#1}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\BuiltInTok}[1]{#1}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\CommentTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{#1}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ErrorTok}[1]{\textcolor[rgb]{0.64,0.00,0.00}{\textbf{#1}}}
\newcommand{\ExtensionTok}[1]{#1}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ImportTok}[1]{#1}
\newcommand{\InformationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\NormalTok}[1]{#1}
\newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.81,0.36,0.00}{\textbf{#1}}}
\newcommand{\OtherTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\RegionMarkerTok}[1]{#1}
\newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\VariableTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\WarningTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\usepackage{graphicx}
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
% Scale images if necessary, so that they will not overflow the page
% margins by default, and it is still possible to overwrite the defaults
% using explicit options in \includegraphics[width, height, ...]{}
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}
% Set default figure placement to htbp
\makeatletter
\def\fps@figure{htbp}
\makeatother
\setlength{\emergencystretch}{3em} % prevent overfull lines
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
\setcounter{secnumdepth}{-\maxdimen} % remove section numbering
\usepackage{booktabs}
\usepackage{longtable}
\usepackage{array}
\usepackage{multirow}
\usepackage{wrapfig}
\usepackage{float}
\usepackage{colortbl}
\usepackage{pdflscape}
\usepackage{tabu}
\usepackage{threeparttable}
\usepackage{threeparttablex}
\usepackage[normalem]{ulem}
\usepackage{makecell}
\usepackage{xcolor}
\ifLuaTeX
  \usepackage{selnolig}  % disable illegal ligatures
\fi

\title{Topic 6: Topic Analysis}
\author{Felicia Cruz, Mia Forsline, Cullen Molitor, Marie Rivers}
\date{2022-05-10}

\begin{document}
\maketitle

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#install packages if necessary, then load libraries}
\ControlFlowTok{if}\NormalTok{ (}\SpecialCharTok{!}\FunctionTok{require}\NormalTok{(librarian))\{}
  \FunctionTok{install.packages}\NormalTok{(}\StringTok{"librarian"}\NormalTok{)}
  \FunctionTok{library}\NormalTok{(librarian)}
\NormalTok{\}}

\NormalTok{librarian}\SpecialCharTok{::}\FunctionTok{shelf}\NormalTok{(}
\NormalTok{  forcats, }
\NormalTok{  ggplot2,}
\NormalTok{  ggraph,}
\NormalTok{  here,}
\NormalTok{  igraph, }\CommentTok{\#network plots}
\NormalTok{  kableExtra,}
\NormalTok{  ldatuning,}
\NormalTok{  LDAvis,}
\NormalTok{  lubridate,}
\NormalTok{  palettetown,}
\NormalTok{  pdftools,}
\NormalTok{  quanteda,}
\NormalTok{  quanteda.textstats,}
\NormalTok{  quanteda.texplots,}
\NormalTok{  readr,}
\NormalTok{  readtext, }\CommentTok{\#quanted subpackage for reading pdfs}
\NormalTok{  reshape2,}
\NormalTok{  stringr,}
\NormalTok{  tidyr,}
\NormalTok{  tidytext,}
\NormalTok{  tidyverse,}
\NormalTok{  tm,}
\NormalTok{  topicmodels,}
  \StringTok{"tsne"}\NormalTok{,}
\NormalTok{  widyr}
\NormalTok{  )}
\end{Highlighting}
\end{Shaded}

\hypertarget{read-in-the-data-from-pdf-files-in-the-data-directory}{%
\section{Read in the data from PDF files in the ``data''
directory}\label{read-in-the-data-from-pdf-files-in-the-data-directory}}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#character of full file paths for each PDF in the data folder }
\NormalTok{files }\OtherTok{\textless{}{-}} \FunctionTok{list.files}\NormalTok{(}\AttributeTok{path =} \FunctionTok{here}\NormalTok{(}\StringTok{"data"}\NormalTok{),}
                    \AttributeTok{pattern =} \StringTok{"pdf$"}\NormalTok{, }\AttributeTok{full.names =} \ConstantTok{TRUE}\NormalTok{)}
\CommentTok{\#create a list}
\NormalTok{scripts }\OtherTok{\textless{}{-}} \FunctionTok{lapply}\NormalTok{(files, pdf\_text)}

\CommentTok{\#create a readtext/dataframe of all PDF scripts }
\NormalTok{scripts\_pdf }\OtherTok{\textless{}{-}} \FunctionTok{readtext}\NormalTok{(}\AttributeTok{file =} \FunctionTok{here}\NormalTok{(}\StringTok{"data"}\NormalTok{, }\StringTok{"*.pdf"}\NormalTok{),}
                              \AttributeTok{docvarsfrom =} \FunctionTok{c}\NormalTok{(}\StringTok{"metadata"}\NormalTok{, }\StringTok{"filenames"}\NormalTok{, }\StringTok{"filepaths"}\NormalTok{),}
                              \AttributeTok{sep =} \StringTok{"\_"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\hypertarget{create-a-clean-corpus}{%
\section{Create a clean corpus}\label{create-a-clean-corpus}}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#creating an initial corpus containing our data}
\NormalTok{script\_corp }\OtherTok{\textless{}{-}} \FunctionTok{corpus}\NormalTok{(}\AttributeTok{x =}\NormalTok{ scripts\_pdf, }\AttributeTok{text\_field =} \StringTok{"text"}\NormalTok{ )}

\CommentTok{\#check the corpus }
\FunctionTok{summary}\NormalTok{(script\_corp) }\SpecialCharTok{\%\textgreater{}\%} 
\NormalTok{  knitr}\SpecialCharTok{::}\FunctionTok{kable}\NormalTok{(}\AttributeTok{caption =} \StringTok{"Summary of Movie Script Corpus"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{table}

\caption{\label{tab:unnamed-chunk-2}Summary of Movie Script Corpus}
\centering
\begin{tabular}[t]{l|r|r|r}
\hline
Text & Types & Tokens & Sentences\\
\hline
an\_inconvenient\_truth.pdf & 2245 & 10936 & 685\\
\hline
before\_the\_flood.pdf & 2540 & 13634 & 863\\
\hline
dont\_look\_up.pdf & 4620 & 28016 & 2825\\
\hline
\end{tabular}
\end{table}

Add additional, context-specific stop words to stop word lexicon

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# more\_stops \textless{}{-}c("2015",}
\CommentTok{\#                "2016", }
\CommentTok{\#                "2017", }
\CommentTok{\#                "2018", }
\CommentTok{\#                "2019", }
\CommentTok{\#                "2020", }
\CommentTok{\#                "www.epa.gov", }
\CommentTok{\#                "https")}
\CommentTok{\# add\_stops \textless{}{-} tibble(word = c(stop\_words$word, more\_stops)) }
\CommentTok{\# stop\_vec \textless{}{-} as\_vector(add\_stops)}
\end{Highlighting}
\end{Shaded}

Tokenize the data into single words and remove stop words

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{toks }\OtherTok{\textless{}{-}} \FunctionTok{tokens}\NormalTok{(script\_corp, }
               \AttributeTok{remove\_punct =} \ConstantTok{TRUE}\NormalTok{, }
               \AttributeTok{remove\_numbers =} \ConstantTok{TRUE}\NormalTok{)}

\CommentTok{\# xxx...add custom stop words such as character names from "Don\textquotesingle{}t Look Up"}
\NormalTok{add\_stops }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\FunctionTok{stopwords}\NormalTok{(}\StringTok{"en"}\NormalTok{),}\StringTok{"xxx"}\NormalTok{, }\StringTok{"yyy"}\NormalTok{, }\StringTok{"zzz"}\NormalTok{)}

\NormalTok{toks1 }\OtherTok{\textless{}{-}} \FunctionTok{tokens\_select}\NormalTok{(toks, }\AttributeTok{pattern =}\NormalTok{ add\_stops, }\AttributeTok{selection =} \StringTok{"remove"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\hypertarget{convert-to-a-document-feature-matrix-dfm}{%
\section{Convert to a document-feature matrix
(dfm)}\label{convert-to-a-document-feature-matrix-dfm}}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{dfm\_comm }\OtherTok{\textless{}{-}} \FunctionTok{dfm}\NormalTok{(toks1, }\AttributeTok{tolower =} \ConstantTok{TRUE}\NormalTok{)}
\NormalTok{dfm }\OtherTok{\textless{}{-}} \FunctionTok{dfm\_wordstem}\NormalTok{(dfm\_comm)}
\NormalTok{dfm }\OtherTok{\textless{}{-}} \FunctionTok{dfm\_trim}\NormalTok{(dfm, }
                \AttributeTok{min\_docfreq =} \DecValTok{3}\NormalTok{, }\CommentTok{\#keep terms that appear in at least 3 documents }
                \AttributeTok{min\_termfreq =} \DecValTok{1}\NormalTok{) }\CommentTok{\#keep terms that appear at least once}

\NormalTok{dfm }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{kbl}\NormalTok{() }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{kable\_styling}\NormalTok{(}\AttributeTok{bootstrap\_options =} \FunctionTok{c}\NormalTok{(}\StringTok{"striped"}\NormalTok{, }\StringTok{"hover"}\NormalTok{),}
                \AttributeTok{latex\_options =} \StringTok{"HOLD\_position"}\NormalTok{) }\CommentTok{\#hold the table position when knitting}
\end{Highlighting}
\end{Shaded}

\begin{table}[H]
\centering
\begin{tabular}[t]{l|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r}
\hline
doc\_id & truth & look & leav & hear & bird & distanc & feel & give & littl & bit & peac & sudden & like & take & breath & go & oh & yeah & forgot & earth & first & pictur & space & us & ever & saw & taken & atmospher & use & next & presid & unit & state & find & particular & funni & tri & tell & stori & long & time & fail & get & messag & across & polit & proud & new & orlean & background & good & peopl & hold & recogn & make & big & chang & lost & went & around & dark & side & came & back & becam & known & one & human & kind & dramat & within & month & movement & last & common & publish & sun & direct & behind & fulli & part & show & almost & never & seen & call & explor & solar & system & graviti & turn & took & day & second & beauti & way & made & satellit & year & togeth & cloud & free & view & everi & land & mass & spread & becom & thing & want & two & much & real & school & map & world & front & rais & hand & point & east & south & america & ask & said & cours & heard & well & scienc & advisor & current & know & actual & scientif & obvious & move & now & anoth & fact & problem & think & just & import & believ & lot & mind & right & warm & goe & possibl & impact & mayb & reason & vulner & late & say & globe & pretti & enough & bring & basic & spend & come & light & wave & keep & certain & put & level & start & issu & professor & name & person & idea & measur & amount & data & yet & experi & charl & david & send & weather & balloon & middl & pacif & remot & hard & nose & scientist & realli & young & consid & result & clear & felt & signific & connect & larger & civil & entir & planet & project & futur & head & unless & adjust & seven & can & see & develop & question & equat & vast & major & north & northern & toward & away & fall & alreadi & follow & congress & help & lead & wit & thought & work & senat & wrote & book & ran & pass & address & least & begin & ago & recent & coupl & studi & will & snow & happen & nation & top & daughter & shame & drink & water & half & centuri & face & serious & today & old & also & tip & ice & gone & record & drill & even & differ & oxygen & figur & guy & clean & air & act & eye & read & mountain & thousand & blue & cold & number & sometim & whole & other & close & anybodi & outsid & small & group & present & age & third & million & let & talk & might & complic & power & citi & york & nice & mile & far & bear & natur & done & ladi & gentleman & continu & children & it'll & singl & seem & perfect & okay & allow & govern & massiv & someth & everyth & place & understand & sinc & war & given & extrem & europ & india & attent & degre & past & american & high & set & increas & ocean & aw & worri & model & predict & storm & releas & among & news & media & textbook & hit & damag & oil & rememb & florida & billion & word & god & need & anyth & readi & got & mistak & generat & elect & offici & decis & accept & final & best & event & loss & sever & crazi & catastroph & flood & rain & hour & china & drought & wide & edg & unbeliev & noth & creat & higher & famili & father & rest & kid & live & end & quick & cap & astonish & build & collaps & hous & great & produc & protect & hope & frozen & earlier & feet & secur & percent & complet & open & giant & general & polar & mean & care & engin & averag & stream & carri & run & rate & huge & stop & pump & shut & near & still & worst & crisi & sign & week & catch & hundr & watch & speci & devast & exact & found & line & emerg & quarter & control & matter & break & green & island & fli & base & absolut & wrong & glass & sit & citizen & bodi & home & imagin & center & memori & prepar & threat & concern & sound & whatev & countri & sure & shake & three & popul & babi & mark & reach & pressur & resourc & polici & cut & night & six & white & fire & technolog & benefit & plus & bomb & alway & exist & simpl & bigger & without & scale & forc & everyon & account & play & odd & boil & sens & danger & slowli & stay & collect & nervous & cigarett & grow & die & econom & mani & life & wish & written & intern & theori & rather & doubt & public & may & section & job & charg & train & upon & choos & confer & minut & choic & hmm & wealth & probabl & roll & remov & soon & sell & car & initi & compani & straight & step & finish & transport & save & buy & individu & forward & leadership & though & difficult & guarante & liberti & vote & hole & challeng & process & movi & man & window & chanc\\
\hline
an\_inconvenient\_truth.pdf & 4 & 26 & 5 & 7 & 2 & 3 & 3 & 6 & 6 & 2 & 1 & 4 & 30 & 14 & 3 & 42 & 3 & 3 & 1 & 38 & 11 & 11 & 6 & 20 & 11 & 5 & 6 & 17 & 14 & 6 & 3 & 6 & 10 & 6 & 2 & 1 & 10 & 6 & 6 & 4 & 35 & 1 & 14 & 2 & 3 & 10 & 1 & 15 & 4 & 4 & 4 & 23 & 1 & 1 & 16 & 16 & 18 & 1 & 21 & 6 & 2 & 7 & 8 & 17 & 1 & 4 & 55 & 7 & 5 & 3 & 6 & 4 & 1 & 17 & 2 & 1 & 8 & 3 & 4 & 1 & 12 & 14 & 6 & 8 & 9 & 6 & 1 & 2 & 7 & 1 & 3 & 9 & 19 & 7 & 2 & 20 & 6 & 1 & 68 & 10 & 2 & 3 & 1 & 11 & 7 & 3 & 2 & 3 & 19 & 9 & 14 & 15 & 7 & 2 & 3 & 27 & 1 & 2 & 2 & 9 & 4 & 10 & 10 & 4 & 15 & 11 & 5 & 14 & 6 & 2 & 8 & 15 & 13 & 10 & 1 & 6 & 30 & 10 & 9 & 21 & 11 & 40 & 4 & 5 & 23 & 5 & 14 & 33 & 6 & 5 & 8 & 4 & 9 & 3 & 1 & 17 & 2 & 4 & 4 & 6 & 1 & 3 & 18 & 2 & 3 & 6 & 1 & 11 & 7 & 11 & 12 & 2 & 3 & 3 & 3 & 17 & 5 & 3 & 2 & 1 & 1 & 1 & 1 & 2 & 1 & 4 & 3 & 1 & 4 & 1 & 15 & 13 & 2 & 3 & 2 & 9 & 3 & 2 & 5 & 2 & 5 & 3 & 6 & 2 & 6 & 3 & 1 & 1 & 2 & 21 & 20 & 1 & 5 & 5 & 3 & 3 & 11 & 4 & 1 & 2 & 6 & 5 & 1 & 3 & 4 & 3 & 2 & 4 & 9 & 1 & 3 & 3 & 1 & 4 & 2 & 1 & 1 & 12 & 3 & 6 & 9 & 14 & 4 & 20 & 9 & 4 & 1 & 1 & 1 & 23 & 10 & 3 & 3 & 3 & 6 & 5 & 15 & 2 & 54 & 8 & 11 & 1 & 10 & 15 & 1 & 4 & 5 & 1 & 3 & 3 & 2 & 1 & 7 & 6 & 3 & 7 & 8 & 3 & 4 & 4 & 4 & 1 & 1 & 2 & 2 & 2 & 9 & 2 & 7 & 2 & 2 & 6 & 2 & 5 & 13 & 1 & 1 & 5 & 6 & 3 & 11 & 1 & 1 & 1 & 4 & 4 & 1 & 1 & 7 & 1 & 1 & 1 & 1 & 4 & 7 & 5 & 6 & 5 & 4 & 4 & 3 & 3 & 7 & 4 & 3 & 6 & 6 & 6 & 1 & 6 & 12 & 21 & 1 & 2 & 1 & 3 & 6 & 3 & 3 & 1 & 1 & 1 & 6 & 6 & 3 & 4 & 5 & 9 & 1 & 1 & 3 & 2 & 1 & 3 & 2 & 4 & 2 & 1 & 3 & 3 & 3 & 4 & 4 & 2 & 3 & 3 & 1 & 4 & 1 & 1 & 9 & 3 & 2 & 2 & 1 & 2 & 5 & 3 & 3 & 2 & 4 & 2 & 5 & 5 & 4 & 5 & 2 & 4 & 1 & 1 & 5 & 3 & 2 & 1 & 2 & 2 & 3 & 1 & 7 & 5 & 6 & 2 & 3 & 2 & 6 & 1 & 2 & 2 & 4 & 1 & 2 & 3 & 1 & 5 & 1 & 1 & 1 & 3 & 1 & 2 & 1 & 1 & 1 & 5 & 2 & 3 & 3 & 1 & 1 & 1 & 1 & 1 & 1 & 1 & 1 & 1 & 2 & 1 & 4 & 2 & 4 & 2 & 4 & 1 & 1 & 4 & 1 & 2 & 2 & 1 & 1 & 1 & 1 & 2 & 2 & 2 & 1 & 2 & 3 & 2 & 1 & 3 & 5 & 1 & 3 & 2 & 1 & 1 & 1 & 1 & 7 & 1 & 2 & 1 & 1 & 1 & 1 & 4 & 3 & 3 & 2 & 1 & 1 & 1 & 1 & 2 & 2 & 2 & 1 & 1 & 1 & 2 & 2 & 1 & 2 & 1 & 1 & 2 & 1 & 1 & 1 & 1 & 1 & 1 & 1 & 2 & 1 & 2 & 1 & 1 & 2 & 1 & 1 & 1 & 4 & 1 & 1 & 1 & 1 & 2 & 2 & 1 & 6 & 3 & 4 & 1 & 2 & 1 & 1 & 1 & 1 & 2 & 1 & 1 & 1 & 1 & 1 & 1 & 1 & 1 & 1 & 1 & 1 & 1 & 1 & 1\\
\hline
before\_the\_flood.pdf & 2 & 25 & 5 & 2 & 2 & 1 & 9 & 5 & 5 & 4 & 4 & 4 & 52 & 24 & 8 & 32 & 15 & 24 & 1 & 21 & 10 & 5 & 1 & 17 & 5 & 3 & 4 & 16 & 16 & 4 & 11 & 10 & 10 & 6 & 1 & 1 & 7 & 7 & 3 & 5 & 30 & 2 & 27 & 2 & 2 & 4 & 1 & 8 & 1 & 1 & 10 & 51 & 1 & 1 & 23 & 9 & 60 & 1 & 4 & 15 & 2 & 9 & 5 & 15 & 4 & 3 & 33 & 7 & 15 & 2 & 2 & 1 & 1 & 16 & 1 & 2 & 2 & 5 & 3 & 1 & 4 & 5 & 7 & 7 & 6 & 16 & 1 & 13 & 8 & 1 & 7 & 1 & 12 & 2 & 5 & 25 & 4 & 4 & 36 & 7 & 1 & 2 & 5 & 14 & 6 & 1 & 1 & 11 & 28 & 24 & 5 & 23 & 4 & 3 & 1 & 48 & 2 & 6 & 2 & 12 & 1 & 5 & 2 & 3 & 9 & 3 & 1 & 17 & 15 & 1 & 3 & 47 & 14 & 5 & 3 & 9 & 43 & 1 & 14 & 17 & 34 & 43 & 9 & 17 & 14 & 2 & 23 & 28 & 5 & 5 & 10 & 2 & 5 & 1 & 2 & 24 & 2 & 6 & 9 & 3 & 8 & 2 & 30 & 6 & 1 & 14 & 2 & 12 & 13 & 24 & 15 & 1 & 3 & 1 & 2 & 2 & 4 & 2 & 1 & 2 & 1 & 1 & 1 & 4 & 1 & 2 & 1 & 1 & 4 & 1 & 13 & 23 & 3 & 2 & 3 & 5 & 2 & 5 & 1 & 1 & 3 & 9 & 22 & 5 & 16 & 4 & 1 & 1 & 1 & 53 & 41 & 5 & 4 & 2 & 2 & 4 & 3 & 2 & 5 & 11 & 6 & 12 & 2 & 3 & 6 & 4 & 1 & 2 & 10 & 4 & 1 & 2 & 1 & 2 & 1 & 1 & 3 & 6 & 2 & 3 & 4 & 43 & 5 & 14 & 9 & 1 & 1 & 1 & 2 & 11 & 8 & 4 & 3 & 5 & 19 & 2 & 6 & 4 & 24 & 4 & 5 & 1 & 16 & 17 & 1 & 1 & 3 & 2 & 1 & 1 & 4 & 1 & 1 & 5 & 3 & 1 & 3 & 1 & 13 & 1 & 1 & 2 & 1 & 6 & 3 & 1 & 1 & 3 & 9 & 3 & 8 & 2 & 1 & 15 & 9 & 1 & 1 & 4 & 7 & 2 & 9 & 6 & 1 & 1 & 1 & 2 & 2 & 3 & 9 & 2 & 3 & 3 & 4 & 9 & 7 & 14 & 9 & 5 & 4 & 2 & 4 & 2 & 4 & 7 & 1 & 11 & 6 & 12 & 5 & 9 & 3 & 14 & 2 & 2 & 2 & 5 & 1 & 7 & 1 & 4 & 1 & 1 & 6 & 1 & 12 & 6 & 4 & 7 & 3 & 5 & 23 & 6 & 2 & 11 & 1 & 3 & 2 & 3 & 2 & 2 & 1 & 4 & 2 & 1 & 2 & 2 & 4 & 8 & 3 & 2 & 9 & 8 & 1 & 1 & 3 & 2 & 5 & 1 & 2 & 1 & 4 & 4 & 13 & 6 & 2 & 2 & 2 & 9 & 2 & 2 & 9 & 5 & 3 & 7 & 1 & 1 & 3 & 4 & 13 & 5 & 3 & 1 & 3 & 4 & 11 & 1 & 2 & 2 & 4 & 1 & 1 & 1 & 8 & 7 & 3 & 1 & 7 & 6 & 5 & 3 & 5 & 1 & 2 & 4 & 1 & 4 & 3 & 3 & 1 & 2 & 1 & 2 & 5 & 4 & 2 & 1 & 12 & 1 & 2 & 12 & 1 & 1 & 2 & 5 & 1 & 6 & 4 & 1 & 1 & 1 & 4 & 2 & 6 & 1 & 13 & 3 & 2 & 4 & 9 & 1 & 1 & 5 & 1 & 2 & 5 & 3 & 3 & 2 & 3 & 3 & 2 & 1 & 1 & 1 & 10 & 5 & 1 & 3 & 7 & 2 & 2 & 1 & 1 & 1 & 1 & 1 & 1 & 2 & 2 & 1 & 5 & 1 & 3 & 6 & 2 & 4 & 4 & 7 & 1 & 1 & 2 & 2 & 3 & 2 & 6 & 8 & 1 & 2 & 1 & 2 & 1 & 1 & 3 & 7 & 2 & 1 & 1 & 6 & 2 & 1 & 2 & 3 & 4 & 2 & 7 & 3 & 5 & 1 & 4 & 2 & 3 & 1 & 2 & 3 & 2 & 2 & 1 & 1 & 2 & 1 & 2 & 4 & 4 & 8 & 1 & 2\\
\hline
dont\_look\_up.pdf & 7 & 100 & 11 & 14 & 2 & 3 & 23 & 21 & 10 & 4 & 2 & 8 & 65 & 42 & 7 & 89 & 46 & 35 & 2 & 34 & 17 & 13 & 28 & 34 & 5 & 7 & 3 & 8 & 11 & 9 & 153 & 6 & 15 & 9 & 2 & 3 & 17 & 39 & 11 & 14 & 86 & 3 & 60 & 3 & 16 & 5 & 2 & 20 & 120 & 3 & 25 & 41 & 20 & 1 & 30 & 14 & 3 & 5 & 2 & 24 & 2 & 3 & 3 & 43 & 1 & 1 & 40 & 6 & 7 & 1 & 1 & 11 & 2 & 11 & 1 & 1 & 2 & 8 & 13 & 6 & 8 & 36 & 6 & 7 & 5 & 38 & 2 & 1 & 2 & 2 & 22 & 2 & 50 & 8 & 7 & 14 & 14 & 8 & 10 & 3 & 3 & 9 & 2 & 8 & 3 & 1 & 4 & 2 & 29 & 45 & 51 & 17 & 14 & 4 & 1 & 19 & 14 & 3 & 18 & 10 & 2 & 2 & 4 & 16 & 17 & 13 & 6 & 39 & 12 & 4 & 2 & 86 & 15 & 5 & 4 & 9 & 64 & 13 & 1 & 3 & 41 & 111 & 5 & 5 & 12 & 3 & 51 & 1 & 12 & 2 & 7 & 13 & 2 & 1 & 7 & 55 & 2 & 6 & 6 & 2 & 3 & 3 & 40 & 22 & 3 & 11 & 4 & 20 & 2 & 14 & 1 & 10 & 8 & 9 & 4 & 2 & 1 & 12 & 4 & 2 & 1 & 1 & 2 & 2 & 1 & 7 & 3 & 1 & 9 & 2 & 19 & 44 & 1 & 2 & 3 & 12 & 1 & 1 & 3 & 1 & 1 & 7 & 29 & 4 & 1 & 27 & 1 & 1 & 3 & 50 & 37 & 3 & 15 & 1 & 1 & 2 & 1 & 1 & 12 & 17 & 4 & 11 & 3 & 1 & 10 & 3 & 2 & 6 & 17 & 4 & 3 & 1 & 2 & 5 & 3 & 2 & 15 & 3 & 3 & 2 & 4 & 41 & 1 & 16 & 7 & 2 & 3 & 2 & 8 & 11 & 7 & 1 & 14 & 10 & 6 & 3 & 14 & 2 & 1 & 3 & 2 & 5 & 22 & 5 & 1 & 4 & 32 & 2 & 23 & 3 & 13 & 10 & 3 & 6 & 2 & 1 & 6 & 5 & 8 & 1 & 12 & 2 & 8 & 5 & 3 & 1 & 4 & 2 & 5 & 10 & 32 & 3 & 1 & 6 & 4 & 8 & 3 & 2 & 2 & 3 & 1 & 8 & 6 & 2 & 43 & 7 & 2 & 5 & 5 & 1 & 21 & 1 & 6 & 8 & 26 & 12 & 6 & 16 & 4 & 3 & 2 & 2 & 1 & 3 & 2 & 2 & 8 & 7 & 6 & 7 & 1 & 4 & 2 & 5 & 2 & 1 & 3 & 1 & 1 & 16 & 17 & 2 & 19 & 2 & 1 & 6 & 1 & 3 & 10 & 26 & 35 & 4 & 3 & 51 & 2 & 3 & 1 & 4 & 2 & 1 & 12 & 5 & 3 & 3 & 3 & 8 & 1 & 1 & 2 & 16 & 3 & 1 & 5 & 1 & 1 & 5 & 7 & 2 & 9 & 5 & 5 & 18 & 14 & 10 & 13 & 3 & 2 & 12 & 2 & 41 & 21 & 1 & 1 & 7 & 1 & 9 & 1 & 4 & 4 & 7 & 22 & 23 & 28 & 1 & 20 & 6 & 1 & 1 & 2 & 2 & 10 & 2 & 4 & 11 & 1 & 2 & 3 & 19 & 1 & 1 & 5 & 2 & 2 & 5 & 30 & 1 & 4 & 10 & 9 & 9 & 8 & 2 & 11 & 4 & 10 & 4 & 1 & 3 & 7 & 1 & 5 & 5 & 19 & 4 & 1 & 26 & 1 & 22 & 2 & 2 & 1 & 7 & 7 & 6 & 3 & 21 & 8 & 16 & 1 & 6 & 1 & 2 & 2 & 1 & 1 & 43 & 49 & 5 & 35 & 8 & 2 & 1 & 1 & 1 & 10 & 1 & 3 & 2 & 4 & 1 & 21 & 27 & 1 & 16 & 1 & 1 & 3 & 2 & 5 & 3 & 2 & 5 & 5 & 3 & 23 & 1 & 11 & 10 & 2 & 2 & 1 & 1 & 1 & 3 & 2 & 5 & 1 & 6 & 10 & 7 & 2 & 1 & 2 & 20 & 3 & 1 & 1 & 5 & 2 & 2 & 1 & 1 & 18 & 2 & 1 & 3 & 5 & 3 & 1 & 6 & 2 & 1 & 1 & 1 & 1 & 1 & 1 & 1 & 1 & 1 & 1 & 3 & 5 & 19 & 5 & 4\\
\hline
\end{tabular}
\end{table}

Remove rows (AKA documents) with all zeroes - otherwise the topic model
won't work

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{sel\_idx }\OtherTok{\textless{}{-}}\NormalTok{ slam}\SpecialCharTok{::}\FunctionTok{row\_sums}\NormalTok{(dfm) }\SpecialCharTok{\textgreater{}} \DecValTok{0} 
\NormalTok{dfm }\OtherTok{\textless{}{-}}\NormalTok{ dfm[sel\_idx, ]}

\NormalTok{dfm }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{kbl}\NormalTok{() }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{kable\_styling}\NormalTok{(}\AttributeTok{bootstrap\_options =} \FunctionTok{c}\NormalTok{(}\StringTok{"striped"}\NormalTok{, }\StringTok{"hover"}\NormalTok{),}
                \AttributeTok{latex\_options =} \StringTok{"HOLD\_position"}\NormalTok{) }\CommentTok{\#hold the table position when knitting}
\end{Highlighting}
\end{Shaded}

\begin{table}[H]
\centering
\begin{tabular}[t]{l|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r}
\hline
doc\_id & truth & look & leav & hear & bird & distanc & feel & give & littl & bit & peac & sudden & like & take & breath & go & oh & yeah & forgot & earth & first & pictur & space & us & ever & saw & taken & atmospher & use & next & presid & unit & state & find & particular & funni & tri & tell & stori & long & time & fail & get & messag & across & polit & proud & new & orlean & background & good & peopl & hold & recogn & make & big & chang & lost & went & around & dark & side & came & back & becam & known & one & human & kind & dramat & within & month & movement & last & common & publish & sun & direct & behind & fulli & part & show & almost & never & seen & call & explor & solar & system & graviti & turn & took & day & second & beauti & way & made & satellit & year & togeth & cloud & free & view & everi & land & mass & spread & becom & thing & want & two & much & real & school & map & world & front & rais & hand & point & east & south & america & ask & said & cours & heard & well & scienc & advisor & current & know & actual & scientif & obvious & move & now & anoth & fact & problem & think & just & import & believ & lot & mind & right & warm & goe & possibl & impact & mayb & reason & vulner & late & say & globe & pretti & enough & bring & basic & spend & come & light & wave & keep & certain & put & level & start & issu & professor & name & person & idea & measur & amount & data & yet & experi & charl & david & send & weather & balloon & middl & pacif & remot & hard & nose & scientist & realli & young & consid & result & clear & felt & signific & connect & larger & civil & entir & planet & project & futur & head & unless & adjust & seven & can & see & develop & question & equat & vast & major & north & northern & toward & away & fall & alreadi & follow & congress & help & lead & wit & thought & work & senat & wrote & book & ran & pass & address & least & begin & ago & recent & coupl & studi & will & snow & happen & nation & top & daughter & shame & drink & water & half & centuri & face & serious & today & old & also & tip & ice & gone & record & drill & even & differ & oxygen & figur & guy & clean & air & act & eye & read & mountain & thousand & blue & cold & number & sometim & whole & other & close & anybodi & outsid & small & group & present & age & third & million & let & talk & might & complic & power & citi & york & nice & mile & far & bear & natur & done & ladi & gentleman & continu & children & it'll & singl & seem & perfect & okay & allow & govern & massiv & someth & everyth & place & understand & sinc & war & given & extrem & europ & india & attent & degre & past & american & high & set & increas & ocean & aw & worri & model & predict & storm & releas & among & news & media & textbook & hit & damag & oil & rememb & florida & billion & word & god & need & anyth & readi & got & mistak & generat & elect & offici & decis & accept & final & best & event & loss & sever & crazi & catastroph & flood & rain & hour & china & drought & wide & edg & unbeliev & noth & creat & higher & famili & father & rest & kid & live & end & quick & cap & astonish & build & collaps & hous & great & produc & protect & hope & frozen & earlier & feet & secur & percent & complet & open & giant & general & polar & mean & care & engin & averag & stream & carri & run & rate & huge & stop & pump & shut & near & still & worst & crisi & sign & week & catch & hundr & watch & speci & devast & exact & found & line & emerg & quarter & control & matter & break & green & island & fli & base & absolut & wrong & glass & sit & citizen & bodi & home & imagin & center & memori & prepar & threat & concern & sound & whatev & countri & sure & shake & three & popul & babi & mark & reach & pressur & resourc & polici & cut & night & six & white & fire & technolog & benefit & plus & bomb & alway & exist & simpl & bigger & without & scale & forc & everyon & account & play & odd & boil & sens & danger & slowli & stay & collect & nervous & cigarett & grow & die & econom & mani & life & wish & written & intern & theori & rather & doubt & public & may & section & job & charg & train & upon & choos & confer & minut & choic & hmm & wealth & probabl & roll & remov & soon & sell & car & initi & compani & straight & step & finish & transport & save & buy & individu & forward & leadership & though & difficult & guarante & liberti & vote & hole & challeng & process & movi & man & window & chanc\\
\hline
an\_inconvenient\_truth.pdf & 4 & 26 & 5 & 7 & 2 & 3 & 3 & 6 & 6 & 2 & 1 & 4 & 30 & 14 & 3 & 42 & 3 & 3 & 1 & 38 & 11 & 11 & 6 & 20 & 11 & 5 & 6 & 17 & 14 & 6 & 3 & 6 & 10 & 6 & 2 & 1 & 10 & 6 & 6 & 4 & 35 & 1 & 14 & 2 & 3 & 10 & 1 & 15 & 4 & 4 & 4 & 23 & 1 & 1 & 16 & 16 & 18 & 1 & 21 & 6 & 2 & 7 & 8 & 17 & 1 & 4 & 55 & 7 & 5 & 3 & 6 & 4 & 1 & 17 & 2 & 1 & 8 & 3 & 4 & 1 & 12 & 14 & 6 & 8 & 9 & 6 & 1 & 2 & 7 & 1 & 3 & 9 & 19 & 7 & 2 & 20 & 6 & 1 & 68 & 10 & 2 & 3 & 1 & 11 & 7 & 3 & 2 & 3 & 19 & 9 & 14 & 15 & 7 & 2 & 3 & 27 & 1 & 2 & 2 & 9 & 4 & 10 & 10 & 4 & 15 & 11 & 5 & 14 & 6 & 2 & 8 & 15 & 13 & 10 & 1 & 6 & 30 & 10 & 9 & 21 & 11 & 40 & 4 & 5 & 23 & 5 & 14 & 33 & 6 & 5 & 8 & 4 & 9 & 3 & 1 & 17 & 2 & 4 & 4 & 6 & 1 & 3 & 18 & 2 & 3 & 6 & 1 & 11 & 7 & 11 & 12 & 2 & 3 & 3 & 3 & 17 & 5 & 3 & 2 & 1 & 1 & 1 & 1 & 2 & 1 & 4 & 3 & 1 & 4 & 1 & 15 & 13 & 2 & 3 & 2 & 9 & 3 & 2 & 5 & 2 & 5 & 3 & 6 & 2 & 6 & 3 & 1 & 1 & 2 & 21 & 20 & 1 & 5 & 5 & 3 & 3 & 11 & 4 & 1 & 2 & 6 & 5 & 1 & 3 & 4 & 3 & 2 & 4 & 9 & 1 & 3 & 3 & 1 & 4 & 2 & 1 & 1 & 12 & 3 & 6 & 9 & 14 & 4 & 20 & 9 & 4 & 1 & 1 & 1 & 23 & 10 & 3 & 3 & 3 & 6 & 5 & 15 & 2 & 54 & 8 & 11 & 1 & 10 & 15 & 1 & 4 & 5 & 1 & 3 & 3 & 2 & 1 & 7 & 6 & 3 & 7 & 8 & 3 & 4 & 4 & 4 & 1 & 1 & 2 & 2 & 2 & 9 & 2 & 7 & 2 & 2 & 6 & 2 & 5 & 13 & 1 & 1 & 5 & 6 & 3 & 11 & 1 & 1 & 1 & 4 & 4 & 1 & 1 & 7 & 1 & 1 & 1 & 1 & 4 & 7 & 5 & 6 & 5 & 4 & 4 & 3 & 3 & 7 & 4 & 3 & 6 & 6 & 6 & 1 & 6 & 12 & 21 & 1 & 2 & 1 & 3 & 6 & 3 & 3 & 1 & 1 & 1 & 6 & 6 & 3 & 4 & 5 & 9 & 1 & 1 & 3 & 2 & 1 & 3 & 2 & 4 & 2 & 1 & 3 & 3 & 3 & 4 & 4 & 2 & 3 & 3 & 1 & 4 & 1 & 1 & 9 & 3 & 2 & 2 & 1 & 2 & 5 & 3 & 3 & 2 & 4 & 2 & 5 & 5 & 4 & 5 & 2 & 4 & 1 & 1 & 5 & 3 & 2 & 1 & 2 & 2 & 3 & 1 & 7 & 5 & 6 & 2 & 3 & 2 & 6 & 1 & 2 & 2 & 4 & 1 & 2 & 3 & 1 & 5 & 1 & 1 & 1 & 3 & 1 & 2 & 1 & 1 & 1 & 5 & 2 & 3 & 3 & 1 & 1 & 1 & 1 & 1 & 1 & 1 & 1 & 1 & 2 & 1 & 4 & 2 & 4 & 2 & 4 & 1 & 1 & 4 & 1 & 2 & 2 & 1 & 1 & 1 & 1 & 2 & 2 & 2 & 1 & 2 & 3 & 2 & 1 & 3 & 5 & 1 & 3 & 2 & 1 & 1 & 1 & 1 & 7 & 1 & 2 & 1 & 1 & 1 & 1 & 4 & 3 & 3 & 2 & 1 & 1 & 1 & 1 & 2 & 2 & 2 & 1 & 1 & 1 & 2 & 2 & 1 & 2 & 1 & 1 & 2 & 1 & 1 & 1 & 1 & 1 & 1 & 1 & 2 & 1 & 2 & 1 & 1 & 2 & 1 & 1 & 1 & 4 & 1 & 1 & 1 & 1 & 2 & 2 & 1 & 6 & 3 & 4 & 1 & 2 & 1 & 1 & 1 & 1 & 2 & 1 & 1 & 1 & 1 & 1 & 1 & 1 & 1 & 1 & 1 & 1 & 1 & 1 & 1\\
\hline
before\_the\_flood.pdf & 2 & 25 & 5 & 2 & 2 & 1 & 9 & 5 & 5 & 4 & 4 & 4 & 52 & 24 & 8 & 32 & 15 & 24 & 1 & 21 & 10 & 5 & 1 & 17 & 5 & 3 & 4 & 16 & 16 & 4 & 11 & 10 & 10 & 6 & 1 & 1 & 7 & 7 & 3 & 5 & 30 & 2 & 27 & 2 & 2 & 4 & 1 & 8 & 1 & 1 & 10 & 51 & 1 & 1 & 23 & 9 & 60 & 1 & 4 & 15 & 2 & 9 & 5 & 15 & 4 & 3 & 33 & 7 & 15 & 2 & 2 & 1 & 1 & 16 & 1 & 2 & 2 & 5 & 3 & 1 & 4 & 5 & 7 & 7 & 6 & 16 & 1 & 13 & 8 & 1 & 7 & 1 & 12 & 2 & 5 & 25 & 4 & 4 & 36 & 7 & 1 & 2 & 5 & 14 & 6 & 1 & 1 & 11 & 28 & 24 & 5 & 23 & 4 & 3 & 1 & 48 & 2 & 6 & 2 & 12 & 1 & 5 & 2 & 3 & 9 & 3 & 1 & 17 & 15 & 1 & 3 & 47 & 14 & 5 & 3 & 9 & 43 & 1 & 14 & 17 & 34 & 43 & 9 & 17 & 14 & 2 & 23 & 28 & 5 & 5 & 10 & 2 & 5 & 1 & 2 & 24 & 2 & 6 & 9 & 3 & 8 & 2 & 30 & 6 & 1 & 14 & 2 & 12 & 13 & 24 & 15 & 1 & 3 & 1 & 2 & 2 & 4 & 2 & 1 & 2 & 1 & 1 & 1 & 4 & 1 & 2 & 1 & 1 & 4 & 1 & 13 & 23 & 3 & 2 & 3 & 5 & 2 & 5 & 1 & 1 & 3 & 9 & 22 & 5 & 16 & 4 & 1 & 1 & 1 & 53 & 41 & 5 & 4 & 2 & 2 & 4 & 3 & 2 & 5 & 11 & 6 & 12 & 2 & 3 & 6 & 4 & 1 & 2 & 10 & 4 & 1 & 2 & 1 & 2 & 1 & 1 & 3 & 6 & 2 & 3 & 4 & 43 & 5 & 14 & 9 & 1 & 1 & 1 & 2 & 11 & 8 & 4 & 3 & 5 & 19 & 2 & 6 & 4 & 24 & 4 & 5 & 1 & 16 & 17 & 1 & 1 & 3 & 2 & 1 & 1 & 4 & 1 & 1 & 5 & 3 & 1 & 3 & 1 & 13 & 1 & 1 & 2 & 1 & 6 & 3 & 1 & 1 & 3 & 9 & 3 & 8 & 2 & 1 & 15 & 9 & 1 & 1 & 4 & 7 & 2 & 9 & 6 & 1 & 1 & 1 & 2 & 2 & 3 & 9 & 2 & 3 & 3 & 4 & 9 & 7 & 14 & 9 & 5 & 4 & 2 & 4 & 2 & 4 & 7 & 1 & 11 & 6 & 12 & 5 & 9 & 3 & 14 & 2 & 2 & 2 & 5 & 1 & 7 & 1 & 4 & 1 & 1 & 6 & 1 & 12 & 6 & 4 & 7 & 3 & 5 & 23 & 6 & 2 & 11 & 1 & 3 & 2 & 3 & 2 & 2 & 1 & 4 & 2 & 1 & 2 & 2 & 4 & 8 & 3 & 2 & 9 & 8 & 1 & 1 & 3 & 2 & 5 & 1 & 2 & 1 & 4 & 4 & 13 & 6 & 2 & 2 & 2 & 9 & 2 & 2 & 9 & 5 & 3 & 7 & 1 & 1 & 3 & 4 & 13 & 5 & 3 & 1 & 3 & 4 & 11 & 1 & 2 & 2 & 4 & 1 & 1 & 1 & 8 & 7 & 3 & 1 & 7 & 6 & 5 & 3 & 5 & 1 & 2 & 4 & 1 & 4 & 3 & 3 & 1 & 2 & 1 & 2 & 5 & 4 & 2 & 1 & 12 & 1 & 2 & 12 & 1 & 1 & 2 & 5 & 1 & 6 & 4 & 1 & 1 & 1 & 4 & 2 & 6 & 1 & 13 & 3 & 2 & 4 & 9 & 1 & 1 & 5 & 1 & 2 & 5 & 3 & 3 & 2 & 3 & 3 & 2 & 1 & 1 & 1 & 10 & 5 & 1 & 3 & 7 & 2 & 2 & 1 & 1 & 1 & 1 & 1 & 1 & 2 & 2 & 1 & 5 & 1 & 3 & 6 & 2 & 4 & 4 & 7 & 1 & 1 & 2 & 2 & 3 & 2 & 6 & 8 & 1 & 2 & 1 & 2 & 1 & 1 & 3 & 7 & 2 & 1 & 1 & 6 & 2 & 1 & 2 & 3 & 4 & 2 & 7 & 3 & 5 & 1 & 4 & 2 & 3 & 1 & 2 & 3 & 2 & 2 & 1 & 1 & 2 & 1 & 2 & 4 & 4 & 8 & 1 & 2\\
\hline
dont\_look\_up.pdf & 7 & 100 & 11 & 14 & 2 & 3 & 23 & 21 & 10 & 4 & 2 & 8 & 65 & 42 & 7 & 89 & 46 & 35 & 2 & 34 & 17 & 13 & 28 & 34 & 5 & 7 & 3 & 8 & 11 & 9 & 153 & 6 & 15 & 9 & 2 & 3 & 17 & 39 & 11 & 14 & 86 & 3 & 60 & 3 & 16 & 5 & 2 & 20 & 120 & 3 & 25 & 41 & 20 & 1 & 30 & 14 & 3 & 5 & 2 & 24 & 2 & 3 & 3 & 43 & 1 & 1 & 40 & 6 & 7 & 1 & 1 & 11 & 2 & 11 & 1 & 1 & 2 & 8 & 13 & 6 & 8 & 36 & 6 & 7 & 5 & 38 & 2 & 1 & 2 & 2 & 22 & 2 & 50 & 8 & 7 & 14 & 14 & 8 & 10 & 3 & 3 & 9 & 2 & 8 & 3 & 1 & 4 & 2 & 29 & 45 & 51 & 17 & 14 & 4 & 1 & 19 & 14 & 3 & 18 & 10 & 2 & 2 & 4 & 16 & 17 & 13 & 6 & 39 & 12 & 4 & 2 & 86 & 15 & 5 & 4 & 9 & 64 & 13 & 1 & 3 & 41 & 111 & 5 & 5 & 12 & 3 & 51 & 1 & 12 & 2 & 7 & 13 & 2 & 1 & 7 & 55 & 2 & 6 & 6 & 2 & 3 & 3 & 40 & 22 & 3 & 11 & 4 & 20 & 2 & 14 & 1 & 10 & 8 & 9 & 4 & 2 & 1 & 12 & 4 & 2 & 1 & 1 & 2 & 2 & 1 & 7 & 3 & 1 & 9 & 2 & 19 & 44 & 1 & 2 & 3 & 12 & 1 & 1 & 3 & 1 & 1 & 7 & 29 & 4 & 1 & 27 & 1 & 1 & 3 & 50 & 37 & 3 & 15 & 1 & 1 & 2 & 1 & 1 & 12 & 17 & 4 & 11 & 3 & 1 & 10 & 3 & 2 & 6 & 17 & 4 & 3 & 1 & 2 & 5 & 3 & 2 & 15 & 3 & 3 & 2 & 4 & 41 & 1 & 16 & 7 & 2 & 3 & 2 & 8 & 11 & 7 & 1 & 14 & 10 & 6 & 3 & 14 & 2 & 1 & 3 & 2 & 5 & 22 & 5 & 1 & 4 & 32 & 2 & 23 & 3 & 13 & 10 & 3 & 6 & 2 & 1 & 6 & 5 & 8 & 1 & 12 & 2 & 8 & 5 & 3 & 1 & 4 & 2 & 5 & 10 & 32 & 3 & 1 & 6 & 4 & 8 & 3 & 2 & 2 & 3 & 1 & 8 & 6 & 2 & 43 & 7 & 2 & 5 & 5 & 1 & 21 & 1 & 6 & 8 & 26 & 12 & 6 & 16 & 4 & 3 & 2 & 2 & 1 & 3 & 2 & 2 & 8 & 7 & 6 & 7 & 1 & 4 & 2 & 5 & 2 & 1 & 3 & 1 & 1 & 16 & 17 & 2 & 19 & 2 & 1 & 6 & 1 & 3 & 10 & 26 & 35 & 4 & 3 & 51 & 2 & 3 & 1 & 4 & 2 & 1 & 12 & 5 & 3 & 3 & 3 & 8 & 1 & 1 & 2 & 16 & 3 & 1 & 5 & 1 & 1 & 5 & 7 & 2 & 9 & 5 & 5 & 18 & 14 & 10 & 13 & 3 & 2 & 12 & 2 & 41 & 21 & 1 & 1 & 7 & 1 & 9 & 1 & 4 & 4 & 7 & 22 & 23 & 28 & 1 & 20 & 6 & 1 & 1 & 2 & 2 & 10 & 2 & 4 & 11 & 1 & 2 & 3 & 19 & 1 & 1 & 5 & 2 & 2 & 5 & 30 & 1 & 4 & 10 & 9 & 9 & 8 & 2 & 11 & 4 & 10 & 4 & 1 & 3 & 7 & 1 & 5 & 5 & 19 & 4 & 1 & 26 & 1 & 22 & 2 & 2 & 1 & 7 & 7 & 6 & 3 & 21 & 8 & 16 & 1 & 6 & 1 & 2 & 2 & 1 & 1 & 43 & 49 & 5 & 35 & 8 & 2 & 1 & 1 & 1 & 10 & 1 & 3 & 2 & 4 & 1 & 21 & 27 & 1 & 16 & 1 & 1 & 3 & 2 & 5 & 3 & 2 & 5 & 5 & 3 & 23 & 1 & 11 & 10 & 2 & 2 & 1 & 1 & 1 & 3 & 2 & 5 & 1 & 6 & 10 & 7 & 2 & 1 & 2 & 20 & 3 & 1 & 1 & 5 & 2 & 2 & 1 & 1 & 18 & 2 & 1 & 3 & 5 & 3 & 1 & 6 & 2 & 1 & 1 & 1 & 1 & 1 & 1 & 1 & 1 & 1 & 1 & 3 & 5 & 19 & 5 & 4\\
\hline
\end{tabular}
\end{table}

\hypertarget{choose-a-number-of-latent-topics-k-and-run-the-gibbs-topic-analysis}{%
\section{Choose a number of latent topics (k) and run the Gibbs topic
analysis}\label{choose-a-number-of-latent-topics-k-and-run-the-gibbs-topic-analysis}}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{k }\OtherTok{\textless{}{-}} \DecValTok{7} \CommentTok{\#k is the number of topics}

\NormalTok{topicModel\_k7 }\OtherTok{\textless{}{-}} \FunctionTok{LDA}\NormalTok{(dfm, }
\NormalTok{                     k, }
                     \AttributeTok{method=}\StringTok{"Gibbs"}\NormalTok{, }
                     \AttributeTok{control=}\FunctionTok{list}\NormalTok{(}\AttributeTok{iter =} \DecValTok{500}\NormalTok{, }\AttributeTok{verbose =} \DecValTok{25}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## K = 7; V = 546; M = 3
## Sampling 500 iterations!
## Iteration 25 ...
## Iteration 50 ...
## Iteration 75 ...
## Iteration 100 ...
## Iteration 125 ...
## Iteration 150 ...
## Iteration 175 ...
## Iteration 200 ...
## Iteration 225 ...
## Iteration 250 ...
## Iteration 275 ...
## Iteration 300 ...
## Iteration 325 ...
## Iteration 350 ...
## Iteration 375 ...
## Iteration 400 ...
## Iteration 425 ...
## Iteration 450 ...
## Iteration 475 ...
## Iteration 500 ...
## Gibbs sampling completed!
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{tmResult }\OtherTok{\textless{}{-}} \FunctionTok{posterior}\NormalTok{(topicModel\_k7)}
\CommentTok{\#attributes(tmResult) \#terms and topics }
 
\NormalTok{beta }\OtherTok{\textless{}{-}}\NormalTok{ tmResult}\SpecialCharTok{$}\NormalTok{terms   }\CommentTok{\# get beta from results}
\CommentTok{\#dim(beta)                \# K distributions over nTerms(DTM) terms }

\FunctionTok{terms}\NormalTok{(topicModel\_k7, }\DecValTok{10}\NormalTok{) }\CommentTok{\#view the terms from each topic }
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##       Topic 1  Topic 2     Topic 3   Topic 4  Topic 5   Topic 6  Topic 7 
##  [1,] "presid" "just"      "world"   "peopl"  "year"    "know"   "earth" 
##  [2,] "orlean" "time"      "chang"   "see"    "ice"     "now"    "one"   
##  [3,] "look"   "back"      "come"    "thing"  "go"      "right"  "like"  
##  [4,] "go"     "show"      "much"    "like"   "warm"    "will"   "lot"   
##  [5,] "oh"     "well"      "today"   "make"   "one"     "can"    "use"   
##  [6,] "two"    "scientist" "can"     "start"  "problem" "say"    "first" 
##  [7,] "got"    "day"       "last"    "live"   "ocean"   "like"   "nation"
##  [8,] "night"  "new"       "power"   "point"  "water"   "realli" "half"  
##  [9,] "cut"    "big"       "kind"    "enough" "look"    "get"    "set"   
## [10,] "tell"   "happen"    "percent" "place"  "way"     "think"  "way"
\end{verbatim}

\hypertarget{calculate-metrics-from-the-data}{%
\section{Calculate metrics from the
data}\label{calculate-metrics-from-the-data}}

\hypertarget{caojuan-2009-deveaud2014-method}{%
\subsection{CaoJuan 2009 \& Deveaud2014
method}\label{caojuan-2009-deveaud2014-method}}

It seems like 7 topics is the ideal number

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{result }\OtherTok{\textless{}{-}} \FunctionTok{FindTopicsNumber}\NormalTok{(}
\NormalTok{  dfm,}
  \AttributeTok{topics =} \FunctionTok{seq}\NormalTok{(}\AttributeTok{from =} \DecValTok{2}\NormalTok{, }\AttributeTok{to =} \DecValTok{20}\NormalTok{, }\AttributeTok{by =} \DecValTok{1}\NormalTok{),}
  \AttributeTok{metrics =} \FunctionTok{c}\NormalTok{(}\StringTok{"CaoJuan2009"}\NormalTok{,  }\StringTok{"Deveaud2014"}\NormalTok{),}
  \AttributeTok{method =} \StringTok{"Gibbs"}\NormalTok{,}
  \AttributeTok{control =} \FunctionTok{list}\NormalTok{(}\AttributeTok{seed =} \DecValTok{77}\NormalTok{),}
  \AttributeTok{verbose =} \ConstantTok{TRUE}
\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## fit models... done.
## calculate metrics:
##   CaoJuan2009... done.
##   Deveaud2014... done.
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{FindTopicsNumber\_plot}\NormalTok{(result)}
\end{Highlighting}
\end{Shaded}

\includegraphics{assignment_5_topic_analysis_files/figure-latex/unnamed-chunk-9-1.pdf}
\#\# Griffiths2004 \& CaoJuan2009 method

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{result }\OtherTok{\textless{}{-}} \FunctionTok{FindTopicsNumber}\NormalTok{(}
\NormalTok{  dfm,}
  \AttributeTok{topics =} \FunctionTok{seq}\NormalTok{(}\AttributeTok{from =} \DecValTok{2}\NormalTok{, }\AttributeTok{to =} \DecValTok{20}\NormalTok{, }\AttributeTok{by =} \DecValTok{1}\NormalTok{),}
  \AttributeTok{metrics =} \FunctionTok{c}\NormalTok{(}\StringTok{"CaoJuan2009"}\NormalTok{, }\StringTok{"Griffiths2004"}\NormalTok{),}
  \AttributeTok{method =} \StringTok{"Gibbs"}\NormalTok{,}
  \AttributeTok{control =} \FunctionTok{list}\NormalTok{(}\AttributeTok{seed =} \DecValTok{77}\NormalTok{),}
  \AttributeTok{verbose =} \ConstantTok{TRUE}
\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## fit models... done.
## calculate metrics:
##   CaoJuan2009... done.
##   Griffiths2004... done.
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{FindTopicsNumber\_plot}\NormalTok{(result)}
\end{Highlighting}
\end{Shaded}

\includegraphics{assignment_5_topic_analysis_files/figure-latex/unnamed-chunk-10-1.pdf}
\#\# Deveaud2014 method

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{result }\OtherTok{\textless{}{-}} \FunctionTok{FindTopicsNumber}\NormalTok{(}
\NormalTok{  dfm,}
  \AttributeTok{topics =} \FunctionTok{seq}\NormalTok{(}\AttributeTok{from =} \DecValTok{2}\NormalTok{, }\AttributeTok{to =} \DecValTok{20}\NormalTok{, }\AttributeTok{by =} \DecValTok{1}\NormalTok{),}
  \AttributeTok{metrics =} \FunctionTok{c}\NormalTok{(}\StringTok{"CaoJuan2009"}\NormalTok{, }\StringTok{"Deveaud2014"}\NormalTok{),}
  \AttributeTok{method =} \StringTok{"Gibbs"}\NormalTok{,}
  \AttributeTok{control =} \FunctionTok{list}\NormalTok{(}\AttributeTok{seed =} \DecValTok{77}\NormalTok{),}
  \AttributeTok{verbose =} \ConstantTok{TRUE}
\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## fit models... done.
## calculate metrics:
##   CaoJuan2009... done.
##   Deveaud2014... done.
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{FindTopicsNumber\_plot}\NormalTok{(result)}
\end{Highlighting}
\end{Shaded}

\includegraphics{assignment_5_topic_analysis_files/figure-latex/unnamed-chunk-11-1.pdf}

\hypertarget{extract-theta-and-beta-values}{%
\section{Extract theta and beta
values}\label{extract-theta-and-beta-values}}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{theta }\OtherTok{\textless{}{-}}\NormalTok{ tmResult}\SpecialCharTok{$}\NormalTok{topics}
\NormalTok{beta }\OtherTok{\textless{}{-}}\NormalTok{ tmResult}\SpecialCharTok{$}\NormalTok{terms}
\NormalTok{vocab }\OtherTok{\textless{}{-}}\NormalTok{ (}\FunctionTok{colnames}\NormalTok{(beta))}
\end{Highlighting}
\end{Shaded}

Note that the beta value indicates how likely a term is to be in that
particular topic

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{comment\_topics }\OtherTok{\textless{}{-}} \FunctionTok{tidy}\NormalTok{(topicModel\_k7, }\AttributeTok{matrix =} \StringTok{"beta"}\NormalTok{)}

\NormalTok{top\_terms }\OtherTok{\textless{}{-}}\NormalTok{ comment\_topics }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{group\_by}\NormalTok{(topic) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{top\_n}\NormalTok{(}\DecValTok{10}\NormalTok{, beta) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{ungroup}\NormalTok{() }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{arrange}\NormalTok{(topic, }\SpecialCharTok{{-}}\NormalTok{beta)}

\NormalTok{top\_terms}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 71 x 3
##    topic term     beta
##    <int> <chr>   <dbl>
##  1     1 presid 0.0646
##  2     1 orlean 0.0476
##  3     1 look   0.0445
##  4     1 go     0.0352
##  5     1 oh     0.0217
##  6     1 two    0.0217
##  7     1 got    0.0205
##  8     1 night  0.0205
##  9     1 cut    0.0182
## 10     1 tell   0.0178
## # ... with 61 more rows
\end{verbatim}

\hypertarget{graph-the-most-likely-words-per-topic}{%
\section{Graph the most likely words per
topic}\label{graph-the-most-likely-words-per-topic}}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{top\_terms }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{term =} \FunctionTok{reorder}\NormalTok{(term, beta)) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(term, beta, }\AttributeTok{fill =} \FunctionTok{factor}\NormalTok{(topic))) }\SpecialCharTok{+}
  \FunctionTok{geom\_col}\NormalTok{(}\AttributeTok{show.legend =} \ConstantTok{FALSE}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{facet\_wrap}\NormalTok{(}\SpecialCharTok{\textasciitilde{}}\NormalTok{ topic, }\AttributeTok{scales =} \StringTok{"free"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{coord\_flip}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\includegraphics{assignment_5_topic_analysis_files/figure-latex/unnamed-chunk-14-1.pdf}

\hypertarget{assign-topic-names-based-on-the-first-5-words}{%
\section{Assign topic names based on the first 5
words}\label{assign-topic-names-based-on-the-first-5-words}}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{top5termsPerTopic }\OtherTok{\textless{}{-}} \FunctionTok{terms}\NormalTok{(topicModel\_k7, }\DecValTok{5}\NormalTok{)}
\NormalTok{topicNames }\OtherTok{\textless{}{-}} \FunctionTok{apply}\NormalTok{(top5termsPerTopic, }\DecValTok{2}\NormalTok{, paste, }\AttributeTok{collapse=}\StringTok{" "}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\hypertarget{explore-the-theta-matrix}{%
\section{Explore the theta matrix}\label{explore-the-theta-matrix}}

The theta matrix contains the distribution of each topic over each
document

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{exampleIds }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{, }\DecValTok{2}\NormalTok{, }\DecValTok{3}\NormalTok{)}
\NormalTok{N }\OtherTok{\textless{}{-}} \FunctionTok{length}\NormalTok{(exampleIds)}

\CommentTok{\#lapply(epa\_corp[exampleIds], as.character) \#uncomment to view example text}
\CommentTok{\# get topic proportions form example documents}

\NormalTok{topicProportionExamples }\OtherTok{\textless{}{-}}\NormalTok{ theta[exampleIds,]}

\FunctionTok{colnames}\NormalTok{(topicProportionExamples) }\OtherTok{\textless{}{-}}\NormalTok{ topicNames}

\FunctionTok{rownames}\NormalTok{(topicProportionExamples) }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\StringTok{"Before the Flood"}\NormalTok{, }
                                       \StringTok{"Don\textquotesingle{}t Look Up"}\NormalTok{, }
                                       \StringTok{"Inconvient Truth"}\NormalTok{)}

\NormalTok{vizDataFrame }\OtherTok{\textless{}{-}} \FunctionTok{melt}\NormalTok{(}\FunctionTok{cbind}\NormalTok{(}\FunctionTok{data.frame}\NormalTok{(topicProportionExamples),}
                           \AttributeTok{document=}\FunctionTok{factor}\NormalTok{(}\DecValTok{1}\SpecialCharTok{:}\NormalTok{N)), }
                           \AttributeTok{variable.name =} \StringTok{"topic"}\NormalTok{, }
                           \AttributeTok{id.vars =} \StringTok{"document"}\NormalTok{)  }\SpecialCharTok{\%\textgreater{}\%} 
    \FunctionTok{mutate}\NormalTok{(}\AttributeTok{document =} \FunctionTok{case\_when}\NormalTok{(}
\NormalTok{    document }\SpecialCharTok{==} \DecValTok{1} \SpecialCharTok{\textasciitilde{}} \StringTok{"Before the Flood"}\NormalTok{,}
\NormalTok{    document }\SpecialCharTok{==} \DecValTok{2} \SpecialCharTok{\textasciitilde{}} \StringTok{"Don\textquotesingle{}t Look Up"}\NormalTok{,}
\NormalTok{    document }\SpecialCharTok{==} \DecValTok{3} \SpecialCharTok{\textasciitilde{}} \StringTok{"Inconvient Truth"}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\hypertarget{plot-the-distribution-of-each-topic-over-each-document}{%
\section{Plot the distribution of each topic over each
document}\label{plot-the-distribution-of-each-topic-over-each-document}}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(}\AttributeTok{data =}\NormalTok{ vizDataFrame, }\FunctionTok{aes}\NormalTok{(topic, value, }\AttributeTok{fill =}\NormalTok{ document)) }\SpecialCharTok{+}
  \FunctionTok{geom\_bar}\NormalTok{(}\AttributeTok{stat=}\StringTok{"identity"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{theme}\NormalTok{(}\AttributeTok{axis.text.x =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{angle =} \DecValTok{90}\NormalTok{, }\AttributeTok{hjust =} \DecValTok{1}\NormalTok{)) }\SpecialCharTok{+}  
  \FunctionTok{coord\_flip}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{facet\_wrap}\NormalTok{(}\SpecialCharTok{\textasciitilde{}}\NormalTok{ document, }\AttributeTok{ncol =}\NormalTok{ N) }\SpecialCharTok{+} 
  \FunctionTok{labs}\NormalTok{(}\AttributeTok{y =} \StringTok{"Topic Distribution"}\NormalTok{, }
       \AttributeTok{x =} \StringTok{"Topic Name"}\NormalTok{,}
       \AttributeTok{fill =} \StringTok{"Film"}\NormalTok{) }\SpecialCharTok{+} 
  \FunctionTok{scale\_fill\_poke}\NormalTok{(}\AttributeTok{pokemon =} \DecValTok{137}\NormalTok{, }\AttributeTok{spread =} \DecValTok{3}\NormalTok{) }\SpecialCharTok{+} 
  \FunctionTok{theme\_classic}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\includegraphics{assignment_5_topic_analysis_files/figure-latex/unnamed-chunk-17-1.pdf}

Here's a neat JSON-based model visualizer

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#library(LDAvis)}
\CommentTok{\#library("tsne")}
\NormalTok{svd\_tsne }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(x) }\FunctionTok{tsne}\NormalTok{(}\FunctionTok{svd}\NormalTok{(x)}\SpecialCharTok{$}\NormalTok{u)}

\NormalTok{json }\OtherTok{\textless{}{-}} \FunctionTok{createJSON}\NormalTok{(}
  \AttributeTok{phi =}\NormalTok{ tmResult}\SpecialCharTok{$}\NormalTok{terms, }
  \AttributeTok{theta =}\NormalTok{ tmResult}\SpecialCharTok{$}\NormalTok{topics, }
  \AttributeTok{doc.length =} \FunctionTok{rowSums}\NormalTok{(dfm), }
  \AttributeTok{vocab =} \FunctionTok{colnames}\NormalTok{(dfm), }
  \AttributeTok{term.frequency =} \FunctionTok{colSums}\NormalTok{(dfm),}
  \AttributeTok{mds.method =}\NormalTok{ svd\_tsne,}
  \AttributeTok{plot.opts =} \FunctionTok{list}\NormalTok{(}\AttributeTok{xlab=}\StringTok{""}\NormalTok{, }\AttributeTok{ylab=}\StringTok{""}\NormalTok{)}
\NormalTok{)}

\FunctionTok{serVis}\NormalTok{(json)}
\end{Highlighting}
\end{Shaded}


\end{document}
